@model PhotoGallery.Application.DTOs.PhotoDetailsDto

<div class="container-fluid px-3 px-lg-5">
    <div class="row justify-content-center">
        <div class="col-12 col-xl-10">
            <div class="card shadow-sm photo-details-card">
                <div class="card-body">

                    <!-- IMAGE -->
                    <img src="@Model.ImageUrl"
                         alt="Photo"
                         class="photo-img-full mb-4"
                         data-bs-toggle="modal"
                         data-bs-target="#fullscreenPhotoModal" />

                    <!-- DESCRIPTION -->
                    @if (!string.IsNullOrWhiteSpace(Model.Description))
                    {
                        <p class="mb-3">@Model.Description</p>
                    }

                    <!-- HASHTAGS -->
                    @if (Model.Hashtags.Any())
                    {
                        <div class="mb-3">
                            @foreach (var tag in Model.Hashtags)
                            {
                                <span class="badge bg-secondary me-1 mb-1">#@tag</span>
                            }
                        </div>
                    }

                    <!-- ACTIONS -->
                    <div class="mb-3">

                        @if (User.Identity?.IsAuthenticated == true &&
                                                (User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value == Model.AuthorId
                                                || User.IsInRole("Administrator")))
                        {
                            <a asp-controller="Photos"
                               asp-action="Edit"
                               asp-route-id="@Model.Id"
                               class="btn btn-sm btn-outline-primary me-2">
                                Edit
                            </a>
                        }

                        <a asp-controller="Photos"
                           asp-action="Download"
                           asp-route-id="@Model.Id"
                           class="btn btn-sm btn-outline-success me-2">
                            Download
                        </a>

                        @if (User.IsInRole("Administrator"))
                        {
                            <form asp-controller="Photos"
                                  asp-action="Delete"
                                  asp-route-id="@Model.Id"
                                  method="post"
                                  class="d-inline"
                                  onsubmit="return confirm('Are you sure you want to delete this photo?');">

                                @Html.AntiForgeryToken()

                                <button type="submit"
                                        class="btn btn-sm btn-outline-danger">
                                    Delete
                                </button>
                            </form>
                        }
                    </div>

                    <!-- META -->
                    <p class="text-muted mb-4">
                        Uploaded by <strong>@Model.AuthorEmail</strong><br />
                        @Model.UploadedAt
                    </p>

                    <a asp-action="Index"
                       class="btn btn-sm btn-outline-secondary">
                        Back to gallery
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- FULLSCREEN MODAL -->
<div class="modal fade"
     id="fullscreenPhotoModal"
     tabindex="-1"
     aria-label="Fullscreen image (click anywhere to close)">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content bg-black">
            <div class="modal-body p-0 d-flex justify-content-center align-items-center"
                 data-bs-dismiss="modal"
                 style="cursor: zoom-out;">
                <img src="@Model.ImageUrl"
                     class="img-fluid"
                     style="max-height: 100vh; object-fit: contain;" />
            </div>
        </div>
    </div>
</div>

<style>
    .photo-img-full {
        width: 100%;
        max-height: min(70vh, 800px);
        object-fit: contain;
        display: block;
        margin: 0 auto;
        background-color: #f8f9fa;
        cursor: zoom-in;
    }

    .photo-details-card {
        border-radius: 0;
    }

        .photo-details-card .card-body {
            padding: 2rem 3rem;
        }

    @@media (max-width: 768px) {
        .photo-details-card .card-body {
            padding: 1.25rem;
        }
    }
</style>

